import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CopyUrl from '@site/src/components/CopyUrl';

### Create Segmented Audience

<CopyUrl method="POST" url="https://api.iqm.com/api/v3/audience/segmented" />

<div class="endpoint-container">
  <div class="child1">

Creates a segmented audience based on the provided request parameters. Allows creating a new segmented audience with the specified details.

Using Segment IDs (from the [Master API](/guidelines/master-api)), you can build an Audience with the <var>equation</var> field. Segment IDs in parentheses, separated by a vertical bar (|), will be in an 'or' relationship, which will combine the sets of Segments; groups of Segments in parentheses, separated by an ampersand (&), will be in an 'and' relationship, which will build an Audience based on the intersection of those groups. You can see an example of this format in the Request Sample code block on the right-hand side of the page.


| Request Schema | |
| --- | --- |
| `equation` <br /><span class="type-text">string</span> <span class="required-text">required</span> | Equation string representing the segment ID groups in AND/OR relationship
| `audienceName` <br /><span class="type-text">string</span> <span class="required-text">required</span> | Name of the segmented audience to be created (maximum 255 characters) 

<details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem"}}>
    <summary style={{fontSize: "16px"}}>Response Properties</summary>
    <table className="objectProperties">
    <tr>
    <td>`id` <br /><span class="type-text">integer</span></td>
    <td>Audience ID</td>
    </tr>
    <tr>
    <td>`message` <br /><span class="type-text">string</span></td>
    <td>Success message</td>
    </tr>
    </table>
    </details>

</div>
<div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Request Sample"
{
  "equation": "((6388749|6388750)&(6388751|6402730|6392754|5776004))",
  "audienceName": "football-temp"
}
```

```json title="Response 200"
{
  "success": true,
  "data": {
    "audienceId": 1140623,
    "message": "<Audience Name> audience created successfully"
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/getting-started/typescript-prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          id: number;
          message: string;
        };
      };
    };
  };
}

function createSegmentAudienceGroup(): Promise<Responses> {
  const options = {
    method: 'POST',
    url: 'https://api.iqm.com/api/v3/audience/segmented',
    requestBody: {
      content: {
        "application/json": {
          equation: `string`,
          audienceName: `string`,
        }
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

---

### Update Segmented Audience

<CopyUrl method="PUT" url="https://api.iqm.com/api/v3/audience/segmented/{audienceId}" />

<div class="endpoint-container">
  <div class="child1">

Updates an existing segmented audience based on the provided request parameters. Allows modifying the details of an existing segmented audience (name and segments).

| Path Parameter | |
| --- | --- |
| `audienceId` <br /><span class="type-text">integer</span> | [Audience ID](#audience-details-list) |

| Request Schema | |
| --- | --- |
| `equation` <br /><span class="type-text">string</span> <span class="required-text">required</span> | Equation string representing the segment ID groups in AND/OR relationship
| `audienceName` <br /><span class="type-text">string</span> <span class="required-text">required</span> | Name of the segmented audience to be updated (maximum 255 characters)

<details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem"}}>
    <summary style={{fontSize: "16px"}}>Response Properties</summary>
    <table className="objectProperties">
    <tr>
    <td>`audienceId` <br /><span class="type-text">integer</span></td>
    <td>Audience ID</td>
    </tr>
    <tr>
    <td>`message` <br /><span class="type-text">string</span></td>
    <td>Success message</td>
    </tr>
    </table>
    </details>

</div>
<div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Request Sample"
{
  "equation": "((5613837|5638265)&(5613844))",
  "name": "Segment audience - 1"
}
```

```json title="Response 200"
{
  "success": true,
  "data": {
    "audienceId": 1140623,
    "message": "<Audience Name> audience updated successfully"
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/getting-started/typescript-prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          message: string;
        };
      };
    };
  };
}

function updateSegmentAudienceGroup(): Promise<Responses> {
  const options = {
    method: 'PUT',
    url: 'https://api.iqm.com/api/v3/audience/segment/{audienceId}',
    params: {
      path: {
        audienceId: `number`,
      }
    },
    requestBody: {
      content: {
        "application/json": {
          advertiserId?: `number`,
          dspId?: `number`,
          owId?: `number`,
          uowId?: `number`,
          name?: `string`,
          equation?: `string`,
        }
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

---

