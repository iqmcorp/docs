import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CopyUrl from '@site/src/components/CopyUrl';

### Create Matched Audience

<CopyUrl method="POST" url="https://api.iqm.com/api/v2/audience/matched/add" />

<div class="container">
  <div class="child1">

Create a Matched Audience. 

<table>
<tr>
<th>Payload (Form Data)</th>
</tr>
  <tr>
   <td>
      `columns` * <br /><span class="type-text">string (FormData)</span>
   </td>
   <td>Matched Audience file columns mapped with system fields. 
This supports a few columns mapping as follows:
<ul><li> FirstName, LastName, State, Zip
      <ul><li>Sample value: <var>\{ "FirstName": "Voters_FirstName", "LastName": "Voters_LastName", "mState": "Residence_Addresses_State", "mZip5": "Residence_Addresses_Zip" }</var></li></ul></li>
   <li>LastName, StreetAddress, State, Zip
      <ul><li>Sample value: <var>\{ "LastName": "Voters_LastName", "StreetAddress": "Residence_Addresses_AddressLine", "mState": "Residence_Addresses_State", "mZip5": "Residence_Addresses_Zip" }</var></li></ul></li>
   <li>StreetAddress, State, Zip
        <ul><li>Sample value: <var>\{ "StreetAddress": "Residence_Addresses_AddressLine", "mState": "Residence_Addresses_State", "mZip5": "Residence_Addresses_Zip" }</var></li></ul></li>
   <li>NPI_ID
        <ul><li>Sample value: <var>\{ "NPI_ID_VALUE": "NPI_ID" }</var></li></ul></li>
   <li>VoterId
        <ul><li>Sample value: <var>\{ "LALVOTERID": "Voters_ID" }</var></li></ul></li>
   <li>Phone
        <ul><li>Sample value: <var>\{ "Phone": "Phone" }</var></li></ul></li>
   <li>Email
        <ul><li>Sample value: <var>\{ "Email": "Email" }</var></li></ul></li>
   <li>FullAddress
        <ul><li>Sample value: <var>\{ "FullAddress": "Residence_FullAddress" }</var></li></ul></li></ul></td>
   </tr>
<tr>
   <td>
      `columnSettings` <br /><span class="type-text">string (FormData)</span>
   </td>
   <td>
Matched Audience columns setting as per the selected columns for matching. Column setting should be as per the selected column as follows:
   <ul><li>FirstName, LastName, State, Zip [not required]</li>
      <li>LastName, StreetAddress, State, Zip [not required]</li>
      <li>StreetAddress, State, Zip [not required]</li>
      <li>LastName, StreetAddress, State, Zip [not required]</li>
      <li>VoterId 
          <ul><li>Value must be a supported voter's [Data Partners ID](#data-partners-list-for-matched-audience)</li>
          <li>Sample value: <var>\{ "Voters_ID": "voterbase_id" }</var></li></ul></li>
      <li>NPI_Id 
          <ul><li>Value must be a supported healthcare [Data Partners ID](#data-partners-list-for-matched-audience)</li>
          <li>Sample value: <var>\{ "NPI_ID": "healthcare_id" }</var></li></ul></li>
      <li>Phone 
          <ul><li>Value must be a supported [Data Format ID](#data-formats-list-for-matched-audience)</li>
          <li>Sample value: <var>\{ "Phone": "SHA1" }</var></li></ul></li>
      <li>Email 
          <ul><li>Value must be a supported [Data Format ID](#data-formats-list-for-matched-audience)</li>
          <li>SampleValue: <var>\{ "Email": "SHA256" }</var></li></ul></li>
      <li>FullAddress [not required]</li></ul>
   </td>
   </tr>
  <tr>
   <td>`audienceName`<br /><span class="type-text">string (FormData)</span> <span class="required-text">required</span></td>
   <td>Name of matched audience</td>
   </tr>
  <tr>
   <td>`metadata`<br /><span class="type-text">string (FormData)</span> <span class="required-text">required</span></td>
   <td>Matched Audience sample data with system fields</td>
   </tr>
  <tr>
   <td>`fileTotalCount`<br /><span class="type-text">integer (FormData)</span> <span class="required-text">required</span></td>
   <td>Total number of records in the uploaded Audience file</td>
   </tr>
  <tr>
   <td>`isSingleColumnEnabled`<br /><span class="type-text">boolean (FormData)</span> <span class="required-text">required</span></td>
   <td>Flag to indicate if the mapping is single column enabled, if the voterId/phone/email/full-address is the primary column mapping then this should be true, and false otherwise. Default value: <var>false</var></td>
  </tr>
</table>

  <details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem" }}>
    <summary style={{fontSize: "16px"}}>Response Properties</summary>
    <table className="objectProperties">
    <tr>
    <td>`id` <br /><span class="type-text">integer</span></td>
    <td>Audience ID</td>
    </tr>
    <tr>
    <td>`message` <br /><span class="type-text">string</span></td>
    <td>Success message</td>
    </tr>
    </table>
    </details>

</div>
<div class="child2a">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```FormData title="Request Sample (FormData)"
------WebKitFormBoundary2LAoPYE0pJvRQ6mQ
Content-Disposition: form-data; name="file"; filename="matched-audience-example.csv"
Content-Type: text/csv

------WebKitFormBoundary2LAoPYE0pJvRQ6mQ
Content-Disposition: form-data; name="columns"

{"first-name":"Voters_FirstName","last-name":"Voters_LastName","zip":"Residence_Addresses_Zip","state":"Residence_Addresses_State","street-address":"Residence_Addresses_AddressLine"}
------WebKitFormBoundary2LAoPYE0pJvRQ6mQ
Content-Disposition: form-data; name="metadata"

{"columns":["registered-voter-id","l2-voter-id","targetsmart-voter-id","first-name","last-name","street-address","city","zip","zipplus4","state","full-address","phone","email","phone-sha256","email-sha256","npi-id"],"fileName":"matched-audience-example.csv","fileSize":1777,"columnValues":{"registered-voter-id":["23457","456789","34567"],"l2-voter-id":["LALNY987654","LALNY76543","LALNY54321"],"targetsmart-voter-id":["NY-000020745","NY-000032452","NY-000069778"],"first-name":["Bilbo","Frodo","Samwise"],"last-name":["Baggins","Baggins","Gamgee"],"street-address":["11 The Shire Middle Earth","22 The Shire Middle Earth","33 The Shire Middle Earth"],"city":["New York","New York","New York"],"zip":["10001","10010","10011"],"zipplus4":["1122","2233","3344"],"state":["NY","New York","NY"],"full-address":["11 The Shire Middle Earth, New York, 10001, NY","22 The Shire Middle Earth, New York, 10010, NY","33 The Shire Middle Earth, New York, 10011, NY"],"phone":["3456789012","5678901234","7890123456"],"email":["Bilbo.Baggins@lotr.com","Frodo.Baggins@lotr.com","Samwise.Gamgee@lotr.com"],"phone-sha256":["26cc49f1a2133f3784b937017f9cc86e05b5413c7f91b0b6bd6375631b68371e","2f510ce904687db4b2706fdaf33f1d0e678be13cc5fe300cf695a546befa5fc8","453fc17260d034186d92d1e58cc557fea9cafc1bf886154b472057feed950605"],"email-sha256":["43f5f8fabe82fc8dce2452267f5550bb036d0ddf33368682a9cd5da8286d63a0","ceb005d969f16f9a6a487849d27bf854fac1f0733aa61995bcbb5cb928dfc410","986c1ae0d3cef60591d3b29aa54afb5d9654406d7cfa4fcbb65c3ad45ad1ce5c"],"npi-id":["1144317652","1467478172","1275506503"]},"rows":5}
------WebKitFormBoundary2LAoPYE0pJvRQ6mQ
Content-Disposition: form-data; name="audienceName"

Matched Audience Sample
------WebKitFormBoundary2LAoPYE0pJvRQ6mQ
Content-Disposition: form-data; name="isSingleColumnEnabled"

false
------WebKitFormBoundary2LAoPYE0pJvRQ6mQ
Content-Disposition: form-data; name="fileTotalCount"

5
------WebKitFormBoundary2LAoPYE0pJvRQ6mQ--
```

```json title="Response 200"
{
   "statusCode": 200,
   "responseObject": {
       "id": 15332,
       "message": "Audience created successfully"
   }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        statusCode: number;
        responseObject: {
          id: number;
          message: string;
        };
      };
    };
  };
}

function addMatchedAudience(): Promise<Responses> {
  const options = {
    method: 'POST',
    url: 'https://api.iqm.com/api/v2/audience/matched/add',
    params: {
      query: {
        columns: `string`,
        columnSettings?: `string`,   
        audienceName: `string`,    
        metadata: `string`,   
        fileTotalCount: `number`,       
        isSingleColumnEnabled: `boolean`,
      },
    },
    requestBody: {
      content: {
        "multipart/form-data": {       
            file: `string`,
        },
      },
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

---

### Update Matched Audience 

<CopyUrl method="PATCH" url="https://api.iqm.com/api/v2/audience/matched/update/{matched_audience_id}" />

<div class="container">
  <div class="child1">

Update a Matched Audience.

| Path Parameter | |
| --- | --- |
| `matched_audience_id` <br /><span class="type-text">integer</span> | Matched [Audience ID](#audience-details-list)

| Request Schema | |
| --- | --- |
| `audienceName` <br /><span class="type-text">string</span> | Audience Name 
| `rawS3URL` <br /><span class="type-text">string</span> | Raw S3 URL 


  <details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem"}}>
    <summary style={{fontSize: "16px"}}>Response Properties</summary>
    <table className="objectProperties">
    <tr>
    <td>`id` <br /><span class="type-text">integer</span></td>
    <td>Audience ID</td>
    </tr>
    <tr>
    <td>`message` <br /><span class="type-text">string</span></td>
    <td>Success message</td>
    </tr>
    </table>
    </details>

</div>
<div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Request Sample"
{
  "audienceName": "Sample audience name",
  "rawS3URL": "s3://sample.url.come"
}
```

```json title="Response 200"
{
  "statusCode": 200,
  "responseObject": {
    "id": 1,
    "message": "Your changes have been saved successfully"
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json;charset=UTF-8": {
        statusCode: number;
        responseObject: {
          id: number;
          message: string;
        };
      };
    };
  };
}

function EditMatchedAudience(): Promise<Responses> {
  const options = {
    method: 'PATCH',
    url: 'https://api.iqm.com/api/v2/audience/matched/update/{matched_audience_Id}',
    params: {
      path: {
        matched_audience_Id: `string`
      }
    },
    requestBody: {
      content: {
        "application/json": {
          audienceName: `string`,
          rawS3URL: `string`,
        }
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>
